
<!DOCTYPE html>
<html>
<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
     
          
</script>
  
<form action="index.php" method="GET">
    <h1>Form interface for POST,PUT,DELETE</h1>
    <hr>
    <br>
    <select required id ="currency_ops">
    </select>
    <br>
    Post: <input required type="Radio" name="action" Value="post"></input>
    Put: <input required type="Radio" name="action" Value="put"></input>
    Delete: <input required type="Radio" name="action" Value="del"></input>
    <br>
    <button id="sButton" type="button" style="background-color:blue;border-color: blue;color:white;font-weight:bold;">Submit</button>
    <br>
    <h4>Response XML</h4><br>
    <textarea id="textArea" rows="20" cols="100">
    </textarea><br>
    
</form>
<script>

  $(document).ready(function(){

var tempArray =[];
var counter =0;
var isBlank = false;
  $.ajax({

    type: "GET",

    url: "../country.xml",

    dataType: "xml",

    success: function(xml){

        $(xml).find('CcyNtry').each(function(i, item) {
        var code = $(this).find('Ccy').text();
        
        var checkCode = tempArray.includes(code);
        if (code ==""){
          isBlank = true; 
        }else{
          isBlank = false
        }  
        if((checkCode == true) || (isBlank == true)){

        }else{
          tempArray.push(code);
          $('#currency_ops').append($('<option>', { 

            value: code,
            text : code,
            id: "currency",counter 

          }));
        }
      
     
        counter++;
    });

  },

  error: function() {

    alert("An error occurred while processing XML file.");

  }

  });

  var selectedAction ="";
  var selectedCurrency ="AFN"

 
  $('#currency_ops').on('change', function() {
    var url = $(this).val(); // get selected value
    if (url) { // require a URL
      //window.location = url; // redirect
      selectedCurrency = url;
    }
    return false;
  });

  $('#sButton').click(function() {
    
    $("#textArea").html(' ');  
    $('input:radio').each(function() {
      if($(this).is(':checked')) {
        // You have a checked radio button here...
        selectedAction = this.value;
      } 
      else {
        // Or an unchecked one here...
      }
    });

   var savedUrl = 'http://localhost/atwd1/assignment/update/?cur='+ selectedCurrency+'&action='+selectedAction;
  

    $.ajax({
        type: "GET",
        url: savedUrl,
        dataType: "xml",
        async: false,
        contentType: "text/xml; charset=\"utf-8\"",
        complete: function(xmlResponse) {
            
              $("#textArea").text(xmlResponse.responseText);
        }
    });



});


});
</script>
</body>
</html>



